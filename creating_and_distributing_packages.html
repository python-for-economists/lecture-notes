<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-03-05 Tue 13:30 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Creating and Distributing Packages</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Guilherme SalomÃ©" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
	     margin-bottom: .2em; }
  .subtitle { text-align: center;
	      font-size: medium;
	      font-weight: bold;
	      margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
	    padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link href="https://fonts.googleapis.com/css?family=Cousine|Open+Sans:300,400|Unica+One" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="../style/post.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Creating and Distributing Packages</h1>
<div class="date-box">
  <div class="date">
    <div class="month">JUL</div>
    <div class="year">2 0 1 9</div>
  </div>
</div>
<div id="endhr"></div>

<p>
The Python Package Index (PyPI, <a href="https://pypi.org">https://pypi.org</a>) is the main repository for Python packages.
PyPI hosts important packages, such as Numpy, Scipy, Tensorflow, Pandas and many others.
PyPI hosts large and well developed packages, but it can also host packages developed by anyone, including you.
These packages can then be installed in any system with <code>pip</code>.
</p>

<p>
In this lecture we will learn how to create a package that can be distributed by PyPI and installed by other Python users.
</p>
<div id="outline-container-orgab19b6f" class="outline-2">
<h2 id="orgab19b6f">Clarifying Concepts: Package, Module, Script</h2>
<div class="outline-text-2" id="text-orgab19b6f">
<p>
A Python <code>script</code> is a text file ending in <code>.py</code> containing Python code that can be interpreted by the Python interpreter.
We can run a script, say <code>script.py</code>, by calling:
</p>
<div class="org-src-container">
<pre class="src src-bash">  python3 script.py
</pre>
</div>
<p>
The contents of the file are then interpreted and executed.
We use scripts to write short programs.
However, when our programs start getting longer, keeping everything in a single file is just not recommended.
The idea is to separate pieces of code that can be reused by our main script into another file (or files).
</p>

<p>
A <code>module</code> is a script file used to organize Python code and which can be reused by other scripts.
Modules are written with the intent of being imported by other scripts or modules, and ideally contain code that can be reused.
For example, you decide your original <code>script.py</code> file is too big and move some of its code to another file, <code>my_module.py</code>.
This file can now be imported inside <code>script.py</code> with a statement like <code>import my_module</code>, which makes whatever was defined in <code>my_module.py</code> available for use.
</p>

<p>
Lastly, a <code>package</code> is a collection of modules, created via a folder hierarchy.
For example, say you have three files <code>stocks.py</code>, <code>futures.py</code> and <code>options.py</code>.
The common theme here is finance.
So we could package these modules into a finance package.
To do so, we create a folder <code>finance/</code> and move all of the module files inside that folder.
We can then import these modules via any script via:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">from</span> finance <span style="color: #51afef;">import</span> stocks, futures, options
</pre>
</div>
<p>
Or:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">import</span> finance.stocks <span style="color: #51afef;">as</span> Stocks
</pre>
</div>

<p>
PyPI hosts packages.
Each project hosted in PyPI is a package, which organizes one or more modules.
Therefore, each project in PyPI is just a collection of python scripts, organized under a single name (namespace).
</p>

<p>
Before we move on to how to host a package on the PyPI repositories and make it available to other Python users, we need to discuss two things: the use of <code>__name__</code> in scripts and modules, and where your local Python searches for modules and packages.
</p>
</div>
</div>
<div id="outline-container-orga23c65e" class="outline-2">
<h2 id="orga23c65e">Module and Scripts: The Global Variable <code>__name__</code></h2>
<div class="outline-text-2" id="text-orga23c65e">
<p>
Whenever Python executes a script, it creates some global variables with various information and then runs the code in the script.
You can check what these variables are with the built-in function <code>globals</code>:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">print</span>(<span style="color: #c678dd;">globals</span>())
</pre>
</div>

<pre class="example">
{'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;, '__spec__': None, '__annotations__': {}, '__builtins__': &lt;module 'builtins' (built-in)&gt;, '__file__': '&lt;stdin&gt;', '__cached__': None}
</pre>


<p>
One of these global variables is <code>__name__</code>.
This variable is used to indicate whether a script file is being run as the main module or is being imported.
Therefore, <code>__name__</code> will contain the string <code>'__main__'</code> if the file is being run as a script, as in <code>python my_script.py</code>.
But, if the file is being imported as a module, as in <code>import my_script</code>, then <code>__name__</code> will contain the name of the module as a string.
</p>

<p>
For example, create the file:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">print</span>(<span style="color: #c678dd;">__name__</span>)
</pre>
</div>
<p>
Save it and run it with <code>python my_script.py</code>.
You will get back the string <code>'__main__'</code>.
</p>

<p>
Now, open a Python REPL and import <code>my_script.py</code>.
To import the file as a module, Python will execute the contents of <code>my_script.py</code> in a separate environment where <code>__name__</code> will be <code>'my_script'</code>.
</p>

<p>
The most common use of the global variable <code>__name__</code> is to create a module that can be imported by other scripts, but that can also be used as a standalone script.
To do so, we check whether <code>__name__</code> corresponds to <code>'__main__'</code> or to the module's name.
For example:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #5B6268;"># </span><span style="color: #5B6268;">My module</span>
<span style="color: #51afef;">def</span> <span style="color: #c678dd;">fibo</span>(n: <span style="color: #c678dd;">int</span>) -&gt; <span style="color: #c678dd;">int</span>:
<span style="background-color: #21242b;"> </span>   <span style="color: #83898d;">"""Computes the nth number of the Fibonacci series."""</span>
<span style="background-color: #21242b;"> </span>   <span style="color: #dcaeea;">phi</span> = (1 + 5 ** 0.5) / 2
<span style="background-color: #21242b;"> </span>   <span style="color: #51afef;">return</span> <span style="color: #c678dd;">int</span>((phi**n-((-phi)**(-n)))/(5**0.5))


<span style="color: #51afef;">if</span> <span style="color: #c678dd;">__name__</span> == <span style="color: #98be65;">'__main__'</span>:
<span style="background-color: #21242b;"> </span>   <span style="color: #51afef;">import</span> sys
<span style="background-color: #21242b;"> </span>   <span style="color: #51afef;">print</span>(fibo(<span style="color: #c678dd;">int</span>(sys.argv[1])))
</pre>
</div>
<p>
If the file above is imported, <code>import my_module</code>, then Python will only execute the definition of the function <code>fibo</code>, since the <code>if</code> part will fail, and then we could access the function via <code>my_module.fibo</code>.
However, if we run the file as a script, then Python will execute the definition of the function, but it will also evaluate the function with whatever arguments were given.
</p>

<p>
In summary, the use of <code>if __name__ ...</code> allows you to have a module that can be imported by other code, but that can also be run independently. The separation of those parts is done by checking whether the code is being imported as a module or run as a script.
</p>
</div>
</div>
<div id="outline-container-org8faff0e" class="outline-2">
<h2 id="org8faff0e">Search Path</h2>
<div class="outline-text-2" id="text-org8faff0e">
<p>
When importing a module (or a package) with <code>import module_name</code>, Python needs to search for files containing the code.
Python first searches for a built-in module with module name.
If the module is not a built-in, then Python starts looking for the module in the folders contained in <code>sys.path</code>.
The first item in the list <code>sys.path</code> will be the folder that contains the script Python is running, or the current directory if Python was launched interactively (REPL).
The list will also contain a folder with a name similar to <code>lib/python3.6/site-packages</code>. This folder, <code>site-packages</code>, is where <code>pip</code> installs the packages.
</p>

<p>
This means, when creating a package, you should be careful about naming, so that it doesn't clash with an existing built-in package.
If your package name is the same as some other package on PyPI then you will be asked to change its name.
</p>
</div>
</div>
<div id="outline-container-org66d5efa" class="outline-2">
<h2 id="org66d5efa">Creating a package containing a single module</h2>
<div class="outline-text-2" id="text-org66d5efa">
<p>
Let's first create a package that contains only a single module.
To do so, we will create the following folders and files:
</p>
<div class="org-src-container">
<pre class="src src-bash">  package_example/
  |-- setup.py
  |-- README.md
  |-- LICENSE.txt
  |-- project_name/
      |-- __init__.py
      |-- sequences.py
</pre>
</div>
<p>
The file <code>setup.py</code> should contain the configurations necessary for PyPI to correctly classify your project and distribute it.
The file <code>README.md</code> should contain the documentation of your project, with information as what APIs are available and how to use them.
The file <code>LICENSE.txt</code> contains the license under which your project is distributed (<a href="https://choosealicense.com">examples</a>).
The following example contains most of the setup you will usually need:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">from</span> setuptools <span style="color: #51afef;">import</span> setup, find_packages

<span style="color: #5B6268;"># </span><span style="color: #5B6268;">Load complete description of project from a markdown file</span>
<span style="color: #51afef;">with</span> <span style="color: #c678dd;">open</span>(<span style="color: #98be65;">"README.md"</span>, <span style="color: #98be65;">"r"</span>) <span style="color: #51afef;">as</span> fh:
<span style="background-color: #21242b;"> </span>   <span style="color: #dcaeea;">long_description</span> = fh.read()

<span style="color: #5B6268;"># </span><span style="color: #5B6268;">Call setup to define project data</span>
setup(
<span style="background-color: #21242b;"> </span>   <span style="color: #5B6268;"># </span><span style="color: #5B6268;">Name of the package: must be unique, later used with pip install</span>
<span style="background-color: #21242b;"> </span>   name=<span style="color: #98be65;">'project_name'</span>,
<span style="background-color: #21242b;"> </span>   <span style="color: #5B6268;"># </span><span style="color: #5B6268;">Project version number: MAJOR.MINOR[.MICRO]</span>
<span style="background-color: #21242b;"> </span>   version=<span style="color: #98be65;">'0.0.1'</span>,
<span style="background-color: #21242b;"> </span>   <span style="color: #5B6268;"># </span><span style="color: #5B6268;">One line description of project</span>
<span style="background-color: #21242b;"> </span>   description=<span style="color: #98be65;">'My project description'</span>,
<span style="background-color: #21242b;"> </span>   <span style="color: #5B6268;"># </span><span style="color: #5B6268;">Project complete documentation (loaded from README.md)</span>
<span style="background-color: #21242b;"> </span>   long_description=long_description,
<span style="background-color: #21242b;"> </span>   long_description_content_type=<span style="color: #98be65;">"text/markdown"</span>,
<span style="background-color: #21242b;"> </span>   <span style="color: #5B6268;"># </span><span style="color: #5B6268;">Project home repository</span>
<span style="background-color: #21242b;"> </span>   url=<span style="color: #98be65;">"http://github.com/username/project_name"</span>,
<span style="background-color: #21242b;"> </span>   <span style="color: #5B6268;"># </span><span style="color: #5B6268;">Author information</span>
<span style="background-color: #21242b;"> </span>   author=<span style="color: #98be65;">"First Name Last Name"</span>,
<span style="background-color: #21242b;"> </span>   author_email=<span style="color: #98be65;">"email@email.com"</span>,
<span style="background-color: #21242b;"> </span>   <span style="color: #5B6268;"># </span><span style="color: #5B6268;">License information</span>
<span style="background-color: #21242b;"> </span>   <span style="color: #a9a1e1;">license</span>=<span style="color: #98be65;">"MIT"</span>,
<span style="background-color: #21242b;"> </span>   <span style="color: #5B6268;"># </span><span style="color: #5B6268;">Name the modules in your package</span>
<span style="background-color: #21242b;"> </span>   packages=find_packages(),
<span style="background-color: #21242b;"> </span>   <span style="color: #5B6268;"># </span><span style="color: #5B6268;">Additional Metadata</span>
<span style="background-color: #21242b;"> </span>   classifiers=[
<span style="background-color: #21242b;"> </span>   <span style="background-color: #21242b;"> </span>   <span style="color: #98be65;">"Programming Language :: Python :: 3 :: Only"</span>,
<span style="background-color: #21242b;"> </span>   <span style="background-color: #21242b;"> </span>   <span style="color: #98be65;">"Programming Language :: Python :: 3.6"</span>,
<span style="background-color: #21242b;"> </span>   <span style="background-color: #21242b;"> </span>   <span style="color: #98be65;">"License :: OSI Approved :: MIT License"</span>,
<span style="background-color: #21242b;"> </span>   <span style="background-color: #21242b;"> </span>   <span style="color: #98be65;">"Operating System :: OS Independent"</span>,
<span style="background-color: #21242b;"> </span>   ],
<span style="background-color: #21242b;"> </span>   <span style="color: #5B6268;"># </span><span style="color: #5B6268;">Dependencies</span>
<span style="background-color: #21242b;"> </span>   install_requires=[
<span style="background-color: #21242b;"> </span>   <span style="background-color: #21242b;"> </span>   <span style="color: #98be65;">"numpy &gt;= 1.15.0"</span>,
<span style="background-color: #21242b;"> </span>   <span style="background-color: #21242b;"> </span>   <span style="color: #98be65;">"pandas &gt;= 0.23.0"</span>,
<span style="background-color: #21242b;"> </span>   <span style="background-color: #21242b;"> </span>   <span style="color: #98be65;">"matplotlib &gt;= 3.0.0"</span>,
<span style="background-color: #21242b;"> </span>   ]
)
</pre>
</div>
<p>
The package <code>setuptools</code> is a package that helps build and distribute other Python packages.
It can be installed with <code>pip install -U setuptools</code>.
We use two of its functions, <code>setup</code> and <code>find_packages</code>.
The function <code>setup</code> is used to define the name and other important information about our project.
The function <code>find_packages</code> is used to automatically find what modules were defined in our package, and it is useful for big projects with numerous files, but can be used for small projects as well.
</p>

<p>
The project version is a string following the format <code>MAJOR.MINOR[.MICRO]</code>. The <code>MAJOR</code> number designates a major change in the package, usually adding many new features, which may change the APIs and break backwards-compatibility.
As an user of a package, we do not want to automatically upgrade this package when a major version is released, since it may break our code.
The <code>MINOR</code> number is changed when there are changes that do not break the APIs or when there are bug fixes.
The optional <code>MICRO</code> number can also be used to indicate bug fixes and very small changes.
</p>

<p>
The <code>classifiers</code> keyword takes a list of strings containing some pre-specified descriptors for projects to help sorting on PyPI's website.
Follow <a href="https://pypi.org/classifiers/">this link</a> for a list of all possible classifiers, and <a href="https://www.python.org/dev/peps/pep-0301/#distutils-trove-classification">this link</a> for PEP 301 which provides some more details on classifiers.
</p>

<p>
Now we can actually define the modules in our package.
To do so, create a folder with the same name as the project, in this case the folder is called <code>project_name</code>.
Inside this folder, create a script named <code>__init__.py</code>.
The <code>__init__.py</code> script tells Python to treat the directory as containing packages.
It is used to organize the <code>import</code> of multiple packages and for small projects is often left empty (empty file).
For now, leave it empty.
</p>

<p>
Lastly, add the module files that contain the code you want to share in the <code>project_name</code> folder. In this case, we have the module <code>sequences.py</code>.
Let's add some code to the module:
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #5B6268;"># </span><span style="color: #5B6268;">sequences.py</span>
<span style="color: #51afef;">def</span> <span style="color: #c678dd;">fibo</span>(n: <span style="color: #c678dd;">int</span>) -&gt; <span style="color: #c678dd;">int</span>:
<span style="background-color: #21242b;"> </span>   <span style="color: #83898d;">"""Computes the nth number of the Fibonacci series."""</span>
<span style="background-color: #21242b;"> </span>   <span style="color: #dcaeea;">phi</span> = (1 + 5 ** 0.5) / 2
<span style="background-color: #21242b;"> </span>   <span style="color: #51afef;">return</span> <span style="color: #c678dd;">int</span>((phi**n-((-phi)**(-n)))/(5**0.5))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga225b8c" class="outline-2">
<h2 id="orga225b8c">Compilation</h2>
<div class="outline-text-2" id="text-orga225b8c">
<p>
Before we can use the module, we need to compile it; and that is where <code>setup.py</code> is used.
Install <code>setuptools</code> and <code>wheel</code> using <code>pip</code>:
</p>
<div class="org-src-container">
<pre class="src src-bash">python3 -m pip install --user --upgrade setuptools wheel
</pre>
</div>
<p>
Then run:
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #5B6268;"># </span><span style="color: #5B6268;">change the working directory to the package_example folder</span>
<span style="color: #c678dd;">cd</span> ~/Desktop/package_example
<span style="color: #5B6268;"># </span><span style="color: #5B6268;">run setup to create install/distribution files</span>
python3 setup.py sdist bdist_wheel
</pre>
</div>
<p>
This will create a source distribution (<code>sdist</code>) and a wheel distribution (<code>bdist_wheel</code>).
The source distribution has all of the files in the folder above, and is similar to zipping your entire project folder.
Since you have the entire project, you can build it on any system.
</p>

<p>
The wheel distribution is also similar to zipping the entire project folder, but includes the compiled binaries from your code. These binaries are specific to your system and to a version of Python. The advantage of a wheel distribution is that it can be installed by simply unzipping its contents in the right location. This makes it fast to install packages on similar systems, since you skip the compilation step.
</p>

<p>
After running the command above, you will notice that a folder called <code>dist</code> was created. In that folder you will find the archives for your package.
Notice the name of the archives depend on the version specified in <code>setup.py</code>.
</p>

<p>
To test if our package works, we will install it locally (without sending it to PyPI). Local installation is crucial when developing the package and ironing out bugs, since you do not want to re-upload to PyPI every time you fix some small issue.
</p>
</div>
</div>
<div id="outline-container-org47bad1d" class="outline-2">
<h2 id="org47bad1d">Using pip to install the package locally</h2>
<div class="outline-text-2" id="text-org47bad1d">
<p>
To install a package locally, we call <code>pip install</code> with the <code>-e</code> option and give it the path to the project we want installed.
For example:
</p>
<div class="org-src-container">
<pre class="src src-bash">pip install -e package_example
</pre>
</div>
<p>
This will install the project in the usual place where Python installs projects, but instead of fetching the project from PyPI it uses the local source.
</p>

<p>
You can now import the package in Python using the name defined in the <code>setup.py</code> file. Remember the package has only one module named <code>sequences.py</code>.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #51afef;">from</span> project_name <span style="color: #51afef;">import</span> sequences
<span style="color: #51afef;">print</span>(sequences.fibo(10))
</pre>
</div>
</div>
</div>
<div id="outline-container-orga56e34f" class="outline-2">
<h2 id="orga56e34f">Using <code>__init__.py</code></h2>
<div class="outline-text-2" id="text-orga56e34f">
<p>
To use the <code>sequences.py</code> module, we first had to import it from the package.
We can use the <code>__init__.py</code> file to make the importing more straightforward.
The <code>__init__.py</code> file is run by Python when importing a package, and it allows us to make the package itself behave as a module.
Modify the <code>__init__.py</code> file to have the following:
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #5B6268;"># </span><span style="color: #5B6268;">__init__.py</span>
<span style="color: #51afef;">from</span> .sequences <span style="color: #51afef;">import</span> fibo
</pre>
</div>
<p>
The <code>.</code> is to tell Python to find the <code>sequences</code> module in the local directory where <code>__init__.py</code> is.
Now, when we <code>import project_name</code>, the <code>__init__.py</code> file is going to be run and its local variables are going to be available under the <code>project_name</code> name space.
</p>

<p>
Since we updated the package, we need to update the version in <code>setup.py</code> and then reinstall it. Update the version number to <code>0.0.2</code> and re-run the following:
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #c678dd;">cd</span> ~/Desktop/package_example
python3 setup.py sdist bdist_wheel
<span style="color: #c678dd;">cd</span> ~/Desktop
pip install -e package_example
</pre>
</div>
<p>
Now, we can import the package and the <code>fibo</code> function will be directly available:
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #51afef;">import</span> project_name
<span style="color: #51afef;">print</span>(project_name.fibo(10))
</pre>
</div>

<p>
The usefulness of <code>__init__.py</code> is to make some parts of the modules directly available under the package name, while keeping the rest of the modules separate.
</p>
</div>
</div>
<div id="outline-container-orgf0865b9" class="outline-2">
<h2 id="orgf0865b9">Creating a package containing multiple modules</h2>
<div class="outline-text-2" id="text-orgf0865b9">
<p>
To add more modules to the package, simply add other <code>.py</code> files containing code to the <code>project_name</code> folder. Then update the version number in <code>setup.py</code> and reinstall.
</p>
</div>
</div>
<div id="outline-container-org0a0e88b" class="outline-2">
<h2 id="org0a0e88b">Distributing your package with PyPI</h2>
<div class="outline-text-2" id="text-org0a0e88b">
<p>
To distribute the package we will use a package called <code>twine</code>.
This package is a utility to assist with publishing packages on PyPI.
Install it with <code>pip</code>:
</p>
<div class="org-src-container">
<pre class="src src-bash">pip install twine
</pre>
</div>
<p>
We will first test uploading our package to a test version of PyPI so that we do not pollute the real PyPI with test projects.
Start by registering an account on <a href="https://test.pypi.org/account/register/">Test PyPI</a>.
Then we can just upload what we have already compiled with <code>twine</code>.
To do so:
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #5B6268;"># </span><span style="color: #5B6268;">Change working directory to project folder</span>
<span style="color: #c678dd;">cd</span> ~/Desktop/package_example
<span style="color: #5B6268;"># </span><span style="color: #5B6268;">Upload the archive files to TestPyPI</span>
twine upload --repository-url https://test.pypi.org/legacy/ dist/*
</pre>
</div>
<p>
Notice that <code>twine</code> is available as a standalone program, even though we installed it with <code>pip</code>.
As an aside, this can be done with any Python program, it is just an extra step when distributing software, but one step we are not interested in right now (more details <a href="https://docs.python-guide.org/shipping/freezing/">here</a>).
</p>

<p>
The command above will upload the contents from the <code>package_example/dist</code> directory to the Test PyPI repository. Remember that the contents of the <code>dist</code> folder are archives of the source code.
The <code>*</code> in <code>dist/*</code> is a special notation for <code>bash</code> which expands to all files in the <code>dist</code> folder.
</p>

<p>
When you run the command for the first time you may get an error about registering your email. Just follow the instructions in the error message and then try again.
</p>

<p>
Notice that we have created two versions of our project, namely versions <code>0.0.1</code> and <code>0.0.2</code>.
When we compile the project for both versions, we created two sets of archives for each version.
The command above will upload the archives for all versions to TestPyPI.
It is important that all versions are available, so that if you need a specific version of the package you can get it from the repository.
</p>

<p>
Now, you can log in <a href="https://test.pypi.org/manage/projects/">Test PyPI</a> and you should see your project there.
To install your project from Test PyPI run the following:
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #5B6268;"># </span><span style="color: #5B6268;">Uninstall the version installed from the local files</span>
pip uninstall project_name
<span style="color: #5B6268;"># </span><span style="color: #5B6268;">Install the version from Test PyPI</span>
pip install -i https://test.pypi.org/simple/ project-name
</pre>
</div>
<p>
Since we are using Test PyPI we need to use the option <code>-i https://test.pypi.org/simple/</code> to let <code>pip</code> know where to find the project.
By default, <code>pip</code> would search on the official PyPI repository.
</p>

<p>
To distribute the package on the official PyPI repository we follow similar steps.
Begin by registering an account on <a href="https://pypi.org/account/register/">PyPI</a>.
Then upload with <code>twine</code>:
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #c678dd;">cd</span> ~/Desktop/package_example
twine upload dist/*
</pre>
</div>
<p>
If there are naming clashes or other issues you will get an error message.
Just follow the steps to fix the issue.
You can now install your package with <code>pip</code>:
</p>
<div class="org-src-container">
<pre class="src src-bash">pip install package_name
</pre>
</div>
</div>
</div>
<div id="outline-container-org83154ff" class="outline-2">
<h2 id="org83154ff">Summary</h2>
<div class="outline-text-2" id="text-org83154ff">
<p>
By the end of this lecture notes you should know:
</p>
<ul class="org-ul">
<li>Difference between: script, module and package</li>
<li>How to use <code>__name__</code> in a module</li>
<li>The places and order where Python searches for packages</li>
<li>How to create a package</li>
<li>How to compile a package</li>
<li>How to install a package from a local source archive</li>
<li>How to use <code>__init__</code> to facilitate importing</li>
<li>How to distribute your package with PyPI</li>
</ul>
<p>
If you find any typos or issues with these notes, please send me an <a href="mailto:guilhermesalome@gmail.com?subject=Feedback:%20Python:%20Topic:%20Creating%20and%20Distributing%20Packages">email</a> with your feedback.
</p>
</div>
</div>
<div id="outline-container-orgbcca22e" class="outline-2">
<h2 id="orgbcca22e">References</h2>
<div class="outline-text-2" id="text-orgbcca22e">
<ul class="org-ul">
<li><a href="https://packaging.python.org/tutorials/packaging-projects/">Packaging Python Projects Tutorial</a></li>
<li><a href="https://setuptools.readthedocs.io/en/latest/setuptools.html">Building and Distributing Packages with setuptools</a></li>
<li><a href="https://packaging.python.org/tutorials/installing-packages/#installing-from-local-archives">Installing Packages</a></li>
<li><a href="https://stackoverflow.com/questions/448271/what-is-init-py-for">What <code>__init__.py</code> is for?</a></li>
<li><a href="https://timothybramlett.com/How_to_create_a_Python_Package_with___init__py.html">How to create a Python Package with <code>__init__.py</code></a></li>
<li><a href="https://packaging.python.org/guides/using-testpypi/">Using TestPyPI</a></li>
</ul>
</div>
</div>
</div>
</body>
</html>
